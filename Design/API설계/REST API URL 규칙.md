### 날짜 : 2023-06-11
### 주제 : REST API URL 규칙
---
### 태그
* #REST, #RESTAPI

### RESTful Api란? 
* REST
	* Representational State Transfer의 약자로 웹을 이용할 때 제약 조건들을 정의하는 소프트웨어 아키텍처 스타일을 말합니다.
* HTTP URL을 통해서 자원(Resource)을 명시하고 HTTP Method(GET, POST, PUT, DELETE)를 통해 해당 자원(URL)에 대한 CRUD를 적용하는 것을 의미합니다. 
* 한마디로 HTTP의 장점을 살리고자 적용하는 통신 규약이라 생각하면 됩니다.


### REST 구성요소
* **자원(Resource)**
	* HTTP URL
* **자원에 대한 행위** 
	* HTTP Method
* **자원에 대한 표현**
	* Representation

### REST 특징
* **인터페이스 일관성**
	* 일관적인 인터페이스로 분리되어야 합니다.
	* 인터페이스 일관성은 4개의 제약 조건을 가지고 있습니다.
		1. 리소스가 URL로 식별되어야 합니다.
		2. 리소스를 CRUD할 때 HTTP메시지에 그 표현을 담아서 전송합니다.
		3. 메시지만 봐도 어떤 의미인지를 해석할 수 있어야 합니다.(self-descriptive message)
		4. 링크를 써서 페이지를 이동합니다.(HATEOS)
	* HATEOS란?
		* HATEOS는 Hypermedia As The Engine of Application State의 줄임말입니다.
		* 그 내용을 조금 쉽게 해석하면 "페이지를 이동할 때, 해당 페이지에 있던 링크(하이퍼링크)를 따라서 이동해야한다"는 제약조건입니다.
		* 장점 
			1. 클라이언트 서버를 중단하지 않고 API 주소를 변경할 수 있습니다.
			2. API를 처음 접하는 사람들에게 좋은 API 목차를 제공합니다.
				 * 예를 들어, 해당 작업에 대한 링크가 있는지 여부에 따라 버튼을 활성화/비활성화할지 등과 같은 일부 조건 구축을 단순화할 수 있습니다. 
			 3. 프런트와 백엔드간의 결합이 적습니다. 
		* 단점
			1. 전송되는 데이터의 크기 때문에 네트워크의 오버헤드가 증가합니다.
			2. 일부 리소스에 대한 링크를 추가하는 것은 때때로 복잡할 수 있으며 이에 따라 컨트롤러를 엉망으로 만들 수도 있습니다. 
			
* **무상태**
	* HTTP는 원래 무상태 프로토콜이며, 상태가 필요하면 상태 정보를 서버에 두지 않고 클라이언트에 의존해야합니다. 
	* **장점**
		* **가시성**
			* 시스템이 요청에 대해 그 요청 이상 고민할 필요가 없습니다. 
		* **책임성**
			* 부분 시스템 실패로부터 회복하는 작업을 쉽게 해줍니다.  
		* **확장성**
			* 서버가 요청간 상태정보를 저장할 필요가 없어 자원을 쉽게 해제할 수 있습니다.
	* **단점**
		* 상태를 저장하지 않기에 요청마다 데이터를 반복적으로 보내야 할 수 있어 성능의 문제가 있을 수 있습니다.
		* 여러 클라이언트 환경에 종속적이기에 서버가 애플리케이션에 대해 완전히 제어를 할 수 없게 됩니다. 
		
* **캐시 처리 기능**
	* 클라이언트는 응답을 캐싱할 수 있어야 합니다. 캐시를 통해 대량의 요청을 효율적으로 처리합니다. 
	* **장점**
		* 네트워크 성능은 매우 명확합니다. 
	* **단점**
		* 캐시가 stable한 정보를 담고 있어 최신 상태를 담보하지 못합니다.
		
* **시스템 계층화**
	* 소프트웨어 시스템을 구성하는 다양한 컴포넌트를 계층적으로 분리하여 조직화하는 방법입니다. 
	* 다양한 컴포넌트를 계층적으로 분리하는 것은 다음과 같습니다. 
		* 표현 계층(Presentation Layer)
			* 클라이언트의 요청을 받아들이고, 응답으로 데이터를 제공합니다. 
			* 주로 사용되는 형식은 JSON, XML, HTML등 입니다.
			* MVC 패턴 중 Controller에 해당하는 부분입니다.
		* 응용 계층(Application Layer)
			* 표현 계층과 데이터 계층 사이에서 비즈니스 로직을 실행하는 역할을 수행합니다. 
		* 데이터 계층(Data Layer)
			* 데이터의 저장, 관리, 액세스를 담당합니다. 
	
* **Code on demand**
	* 자바 애플릿이나 자바스크립트의 제공을 통해 서버가 클라이언트를 실행시킬 수 있는 로직을 전송하여 기능을 확장시킬 수 있습니다. 
	
* **클라이언트/서버 구조**
	* 아키텍처를 단순화시키고 작은 단위로 분리함으로써 클라언트 서버의 각 파트가 독립적으로 구분하고 서로간의 의존성을 줄입니다. 



### REST API 설계 Rules 및 예시
#### 1. 소문자를 사용한다.
* 대문자는 때로 문제를 일으키는 경우가 있기에 URI를 작성할 때는 소문자를 선호합니다.
	* `http://localhost/users/Post-Comments`(X)
	* `http://localhost/users/post-comments`(O)

#### 2. 언더바(\_) 대신 하이픈(-)을 사용합니다.
* 가독성을 위해 긴 Path를 표현하는 경우 단어는 하이픈으로 구분하는 것이 좋습니다.
* 프로그램의 글자 폰트에 따라 언더바 문자는 부분적으로 가려지거나 숨겨질 수 있습니다. 

#### 3. 마지막에 슬래스(/)를 포함하지 않습니다.
* 후행 슬래시(/)는 의미가 전혀 없고, 혼란을 야기할 수 있습니다.
* URI 내의 모든 문자는 리소스 고유의 ID에 포함됩니다. URI가 다르면 리소스도 다르기 떄문에 명확한 URI를 생성해야 합니다. 
	* `http://localhost/users/`(X)
	* `http://localhost/users`(O)

#### 4. 행위를 포함하지 않습니다. 
* 행위는 URI 대신 Method를 사용하여 전달합니다.
	* `http://localhost/users/post/1`(X)
	* `http://localhost/users/1`(O)

#### 5. 파일 확장자는 URL에 포함시키지 않습니다. 
* 파일 확장자는 URI에 포함해서는 안됩니다. 대신 Content-Type 헤더를 통해 전달되는 대로 미디어 타입을 사용해 body 컨텐츠를 처리하는 방법을 결정합니다. 
* REST API 클라이언트는 HTTP에서 제공하는 형식 선택 메커니즘을 Accept 요청 헤더를 활용하도록 권장해야 합니다.
	* `http://localhost/users/photo.jpg`(X)
	* `GET http://localhost/users/photo`
	   `HTTP/1.1 Host: localhost Accept: image/jpg`(O)

#### 6. 전달하고자 하는 명사를 사용하되, 컨트롤 자원을 의미하는 경우 예외적으로 동사를 사용합니다.
* `http://localhost/course/writeing`(X)
* `http://localhost/course/write`(O)

### 7. URI에 작성되는 영어를 복수형으로 작성합니다. 
* URI의 형식을 복수형으로 사용하는 것이 실무에서 많이 사용되고 있습니다. 


### REST API 제약 조건은 모두 지켜야 하나요?
* 아닙니다. 로이필딩에 제시한 REST 아키텍처의 제약 조건들은 RESTful API의 이상적인 구현을 위한 원칙들입니다.
* 모든 제약 조건을 엄격히 따르지 못한다고 해서 반드시 REST API라고 할 수 없는 것은 아닙니다. 
* 따라서 RESTful API라고 부르기 위해선 REST 아키텍처의 기본 원칙을 준수하고, 클라이언트와 서버 간의 상호작용을 기반으로 API 디자인을 가져야 합니다. 
* 이를 위해 필요한 제약 조건을 **최대한 준수**하되, 실제 요구 사항과 제한 사항을 고려해 유연성을 적용하는 것이 중요합니다.


### 출처(참고문헌)
-  https://dev-cool.tistory.com/32
* https://doctorson0309.tistory.com/658
* [헤이티오스 관련 문서](https://grapeup.com/blog/how-to-build-hypermedia-api-with-spring-hateoas/#)
* [논문을 통한 REST에 대한 고찰](https://shoark7.github.io/programming/knowledge/what-is-rest)